<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Playground | WriteGPT</title>
        <link
            rel="stylesheet"
            href="https://unpkg.com/tailwindcss@2.2.16/dist/tailwind.min.css"
        />
        <style>
            body {
                background-color: #2e2f39;
            }
        </style>
    </head>
    <body>
        <div class="container mx-auto py-8">
            <h1 class="text-3xl text-white font-bold mb-4">
                WriteGPT Playground
            </h1>
            <div class="container mx-auto py-8 grid grid-cols-2 gap-8">
                <form class="bg-gray-800 p-6 rounded-lg mb-8">
                    <h2 class="text-xl text-white font-semibold mb-4">Input</h2>
                    <div class="mb-4">
                        <label
                            class="block text-gray-400 font-medium mb-2"
                            for="website-url"
                            >Website URL</label
                        >
                        <input
                            class="w-full px-3 py-2 text-gray-700 bg-gray-200 rounded"
                            id="website-url"
                            type="url"
                            name="website-url"
                            required
                        />
                    </div>
                    <div class="mb-4">
                        <label
                            class="block text-gray-400 font-medium mb-2"
                            for="sender-info"
                            >Sender Info</label
                        >
                        <input
                            class="w-full px-3 py-2 text-gray-700 bg-gray-200 rounded"
                            id="sender-info"
                            type="text"
                            name="sender-info"
                            required
                        />
                    </div>
                    <div class="mb-4">
                        <label
                            class="block text-gray-400 font-medium mb-2"
                            for="recipient-info"
                            >Recipient Info</label
                        >
                        <input
                            class="w-full px-3 py-2 text-gray-700 bg-gray-200 rounded"
                            id="recipient-info"
                            type="text"
                            name="recipient-info"
                            required
                        />
                    </div>
                    <div class="mb-4">
                        <label
                            class="block text-gray-400 font-medium mb-2"
                            for="prompt"
                            >Prompt</label
                        >
                        <textarea
                            class="w-full px-3 py-2 text-gray-700 bg-gray-200 rounded"
                            id="prompt"
                            name="prompt"
                            rows="5"
                            required
                        ></textarea>
                    </div>
                    <button
                        id="generate-email-btn"
                        class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                        type="submit"
                    >
                        <span id="generate-email-btn-text">Generate Email</span>
                    </button>
                </form>
                <div class="bg-gray-800 p-6 rounded-lg flex flex-col">
                    <h2 class="text-xl text-white font-semibold mb-4">
                        Output
                    </h2>
                    <div class="relative flex-grow mb-4">
                        <textarea
                            class="w-full h-full px-3 py-2 text-gray-700 bg-gray-200 rounded"
                            id="output"
                            readonly
                        ></textarea>
                        <button
                            class="absolute top-0 right-0 mt-2 mr-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                            type="button"
                            onclick="copyToClipboard()"
                        >
                            Copy
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- ...HTML code from the previous answer... -->
        <script>
            function copyToClipboard() {
                var outputElement = document.getElementById("output");
                outputElement.select();
                document.execCommand("copy");
            }

            const form = document.querySelector("form");
            form.addEventListener("submit", async (event) => {
                event.preventDefault();
                const url = document.querySelector("#website-url").value;
                const senderInfo = document.querySelector("#sender-info").value;
                const recipientInfo =
                    document.querySelector("#recipient-info").value;
                const prompt = document.querySelector("#prompt").value;

                var generateBtn = document.getElementById("generate-email-btn");
                var generateBtnText = document.getElementById(
                    "generate-email-btn-text"
                );
                generateBtn.disabled = true;
                generateBtnText = "Generating...";

                const requestBody = {
                    url,
                    sender_info: senderInfo,
                    recipient_info: recipientInfo,
                    prompt,
                    word_count: 400,
                };

                const response = await fetch("/generate_email", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(requestBody),
                });

                const responseBody = await response.text();
                console.log(responseBody);
                const outputElement = document.querySelector("#output");
                showOutputText(responseBody);
                generateBtn.disabled = false;

                function showOutputText(text) {
                    const outputElement = document.getElementById("output");
                    outputElement.value = "";
                    const words = text.split(" ");
                    let i = 0;
                    const intervalId = setInterval(() => {
                        if (i >= words.length) {
                            clearInterval(intervalId);
                            return;
                        }
                        outputElement.value += words[i] + " ";
                        i++;
                    }, 60);
                }
            });
        </script>
    </body>
</html>
